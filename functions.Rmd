---
title: "Writing Functions in R"
author: "Roya Safaeinili"
output: github_document
---

```{r}
library(tidyverse)
```

Today we will be learning to write our own functions in R.

```{r}
exp_growth <- function(xt,r){
  r * xt
}

simulate <- function(max_time, x0, r){
  
  x <- numeric(max_time)
  x[1] <- x0
  
  for (t in 1:(max_time - 1)){
    x[t+1] <- exp_growth(x[t],r)
  }
  
  pop_data <- data_frame(time = 1:max_time, population_size = x)
  pop_data
  
  
}

simulate(41,10,1.5)
```

```{r}
simulate(41,10,1.5) %>%
  ggplot( aes(x = time, y = population_size)) +
      geom_point() +
      xlab('Time') +
      ylab('Population Size') + 
      ggtitle('Exponential Population Growth')
```
$$x_{t+1} = r x_t \left(1-\frac{x_t}{K}\right)$$

```{r}
growth <- function(xt, r, K){
  x_t <- r * xt*(1-(xt/K))
}


simulate2 <- function(max_time, x0, r, K){
  
  x <- numeric(max_time)
  x[1] <- x0
  
  for (t in 1:(max_time - 1)){
    x[t+1] <- growth(x[t],r,K)
  }
  
  pop_data <- data_frame(time = 1:max_time, population_size = x)
  pop_data
}

simulate2(41,10,1.5,100) %>%
  ggplot(aes(time,population_size)) +
  geom_point() +
  xlab('Time') +
  ylab('Population Size') + 
  ggtitle('Logarithmic Population Growth')
```

